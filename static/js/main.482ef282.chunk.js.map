{"version":3,"sources":["components/MediaStream/index.jsx","App.js","reportWebVitals.js","index.js"],"names":["getDebugData","debugData","components","key","push","className","MediaStream","videoRef","React","useRef","canvasRef","downloadAnchor","useState","mediaSettings","setMediaSettings","setDebugData","getMedia","a","stream","navigator","mediaDevices","getUserMedia","audio","video","facingMode","exact","getVideoTracks","videoTracks","videoTrack","capabilities","getCapabilities","settings","getSettings","console","log","constraints","width","max","height","applyConstraints","updatedSettings","error","useEffect","media","current","srcObject","src","window","URL","createObjectURL","id","ref","autoPlay","playsInline","onLoadedMetadata","e","ctx","getContext","videoWidth","videoHeight","mw","mh","vw","vh","setInterval","drawImage","style","display","href","IconButton","color","aria-label","component","variant","onClick","url","toDataURL","download","click","revokeObjectURL","fontSize","App","DndProvider","backend","TouchBackend","options","enableMouseEvents","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.482ef282.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport PhotoCamera from '@material-ui/icons/PhotoCamera';\r\nimport SettingsOverscanIcon from '@material-ui/icons/SettingsOverscan';\r\n\r\nconst getDebugData = (debugData) => {\r\n\tconst components = [];\r\n\tfor (let key in debugData) {\r\n\t\tcomponents.push(\r\n\t\t\t<div className='debugRow'>\r\n\t\t\t\t<span className='debugLabel'>{key} : </span>\r\n\t\t\t\t<span className='debugValue'>{debugData[key]}</span>\r\n\t\t\t</div>,\r\n\t\t);\r\n\t}\r\n\treturn components;\r\n};\r\n\r\nconst MediaStream = () => {\r\n\tconst debug = true;\r\n\tconst videoRef = React.useRef();\r\n\tconst canvasRef = React.useRef();\r\n\tconst downloadAnchor = React.useRef();\r\n\tconst [mediaSettings, setMediaSettings] = React.useState({});\r\n\tconst [debugData, setDebugData] = useState({});\r\n\tasync function getMedia() {\r\n\t\tlet stream = null;\r\n\r\n\t\ttry {\r\n\t\t\ttry {\r\n\t\t\t\tstream = await navigator.mediaDevices.getUserMedia({\r\n\t\t\t\t\taudio: false,\r\n\t\t\t\t\tvideo: { facingMode: { exact: 'environment' } },\r\n\t\t\t\t});\r\n\t\t\t} catch (err) {\r\n\t\t\t\tstream = await navigator.mediaDevices.getUserMedia({\r\n\t\t\t\t\taudio: false,\r\n\t\t\t\t\tvideo: { facingMode: { exact: 'user' } },\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst videoTracks = await stream.getVideoTracks();\r\n\t\t\tconst videoTrack = videoTracks[0];\r\n\t\t\tconst capabilities = videoTracks[0].getCapabilities();\r\n\t\t\tconst settings = videoTrack.getSettings();\r\n\t\t\tconsole.log(capabilities, settings);\r\n\t\t\tconst constraints = {\r\n\t\t\t\twidth: { exact: capabilities.width.max },\r\n\t\t\t\theight: { exact: capabilities.height.max },\r\n\t\t\t};\r\n\t\t\tawait videoTrack.applyConstraints(constraints);\r\n\t\t\tconst updatedSettings = videoTrack.getSettings();\r\n\t\t\tsetMediaSettings(updatedSettings);\r\n\t\t\treturn { stream, settings: updatedSettings };\r\n\t\t\t/* use the stream */\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(err);\r\n\t\t\t/* handle the error */\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(async () => {\r\n\t\tconst media = await getMedia();\r\n\t\tconsole.log(media.settings);\r\n\t\tif (videoRef.current) {\r\n\t\t\tif ('srcObject' in videoRef.current) {\r\n\t\t\t\tvideoRef.current.srcObject = media.stream;\r\n\r\n\t\t\t\t// ctx.scale(widthRatio, heightRatio);\r\n\t\t\t} else {\r\n\t\t\t\tvideoRef.src = window.URL.createObjectURL(media.stream);\r\n\t\t\t}\r\n\t\t\tvideoRef.current.width = media.settings.width;\r\n\t\t\tvideoRef.current.height = media.settings.height;\r\n\t\t\t//window.visualViewport.height;//media.settings.height;//window.innerHeight;\r\n\t\t}\r\n\t}, [videoRef, canvasRef]);\r\n\tconst metaDataLoadHandle = (e) => {\r\n\t\tconsole.log('loaded', mediaSettings);\r\n\t\tconst ctx = canvasRef.current.getContext('2d');\r\n\t\tcanvasRef.current.width = videoRef.current.videoWidth; //window.visualViewport.width; //media.settings.width;//window.innerWidth;\r\n\t\tcanvasRef.current.height = videoRef.current.videoHeight;\r\n\t\tsetDebugData({\r\n\t\t\tmw: mediaSettings.width,\r\n\t\t\tmh: mediaSettings.height,\r\n\t\t\tvw: videoRef.current.videoWidth,\r\n\t\t\tvh: videoRef.current.videoHeight,\r\n\t\t});\r\n\t\tconsole.log(\r\n\t\t\t'WIDTHHEIGHT',\r\n\t\t\tmediaSettings.width,\r\n\t\t\tmediaSettings.height,\r\n\t\t\tvideoRef.current.videoWidth,\r\n\t\t\tvideoRef.current.videoHeight,\r\n\t\t);\r\n\r\n\t\tsetInterval(() => {\r\n\t\t\t// if ( window. matchMedia(\"(orientation: portrait)\")) {\r\n\t\t\t//     var vRatio = (canvasRef.current.height / videoRef.current.videoHeight) * videoRef.current.videoWidth;\r\n\t\t\t//     ctx.drawImage(videoRef.current, 0,0, vRatio, canvasRef.current.height);\r\n\r\n\t\t\t// } else {\r\n\t\t\t//      // fill horizontally\r\n\t\t\t//      var hRatio = (canvasRef.current.width / videoRef.current.videoWidth) * videoRef.current.videoHeight;\r\n\t\t\t//      ctx.drawImage(videoRef.current, 0,0, canvasRef.current.width, hRatio);\r\n\t\t\t// }\r\n\t\t\tctx.drawImage(videoRef.current, 0, 0, videoRef.current.videoWidth, videoRef.current.videoHeight);\r\n\t\t}, 30);\r\n\t};\r\n\r\n\tconst captureImage = () => {\r\n\t\tconst url = canvasRef.current.toDataURL('image/png');\r\n\t\t// photo.current.setAttribute('src', url);\r\n\t\tdownloadAnchor.current.href = url;\r\n\t\tdownloadAnchor.current.download = 'MyPhoto.png';\r\n\t\tdownloadAnchor.current.click();\r\n\t\t//\r\n\t\twindow.URL.revokeObjectURL(url);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t{debug && <div id='debug'>{getDebugData(debugData)}</div>}\r\n\t\t\t<video\r\n\t\t\t\tref={videoRef}\r\n\t\t\t\tautoPlay\r\n\t\t\t\tplaysInline\r\n\t\t\t\tonLoadedMetadata={metaDataLoadHandle}\r\n\t\t\t\tstyle={{ display: 'none' }}\r\n\t\t\t></video>\r\n\t\t\t<canvas ref={canvasRef}></canvas>\r\n\t\t\t<a id='downloadAnchor' href='http://chetandr.github.com' ref={downloadAnchor} style={{ display: 'none' }}>\r\n\t\t\t\timage\r\n\t\t\t</a>\r\n\t\t\t<div id='changeVideo'>\r\n\t\t\t\t<IconButton\r\n\t\t\t\t\tcolor='primary'\r\n\t\t\t\t\taria-label='upload picture'\r\n\t\t\t\t\tcomponent='span'\r\n\t\t\t\t\tvariant='contained'\r\n\t\t\t\t\t// ref={snap}\r\n\t\t\t\t\tonClick={captureImage}\r\n\t\t\t\t>\r\n\t\t\t\t\t<PhotoCamera style={{ fontSize: 100 }} />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</div>\r\n\t\t\t{/* <div id='additionalButtons'>\r\n\t\t\t\t<IconButton\r\n\t\t\t\t\tcolor='secondary'\r\n\t\t\t\t\taria-label='upload picture'\r\n\t\t\t\t\tcomponent='span'\r\n\t\t\t\t\tvariant='contained'\r\n\t\t\t\t\tref={snap}\r\n\t\t\t\t\tonClick={addBBox}\r\n\t\t\t\t\tdisabled={bboxCount >= allowedBBoxes}\r\n\t\t\t\t>\r\n\t\t\t\t\t<SettingsOverscanIcon style={{ fontSize: 100 }} />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</div> */}\r\n\t\t\t<a id='downloadAnchor' href='http://chetandr.github.com' ref={downloadAnchor} style={{ display: 'none' }}>\r\n\t\t\t\timage\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MediaStream;\r\n","import './App.css';\n\nimport { DndProvider } from 'react-dnd';\nimport MediaStream from './components/MediaStream';\nimport { TouchBackend } from 'react-dnd-touch-backend';\n\nfunction App() {\n\treturn (\n\t\t<DndProvider backend={TouchBackend} options={{ enableMouseEvents: true }}>\n\t\t\t<div className='App'>\n\t\t\t\t<header className='App-header'>\n\t\t\t\t\t<MediaStream />\n\t\t\t\t</header>\n\t\t\t</div>\n\t\t</DndProvider>\n\t);\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}