{"version":3,"sources":["components/capture/browserCompatibility.js","components/capture/browserHelper.js","components/capture/camera.js","components/capture/unsupportedBrowserError.js","components/capture/customError.js","components/capture/cameraAccess.js","components/capture/index.jsx","App.js","reportWebVitals.js","index.js"],"names":["exports","__esModule","BrowserCompatibility","Feature","BrowserHelper","UAParser","js_cookie_1","require","ua_parser_js_1","browserCompatibility_1","userAgentInfo","navigator","userAgent","canvas","document","createElement","checkBrowserCompatibility","objectHasPropertyWithType","object","propertyNames","propertyType","objectProperty","length","slice","fullSupport","scannerSupport","missingFeatures","window","push","MEDIA_DEVICES","WEB_WORKERS","WEB_ASSEMBLY","BLOB","URL_OBJECT","OFFSCREEN_CANVAS","getContext","Error","_a","WEBGL","os","userAgentOS","getOS","name","version","includes","WEB_ASSEMBLY_ERROR_FREE","getDeviceId","storedDeviceId","get","randomDeviceId","i","charAt","Math","floor","random","set","expires","isValidHTMLElement","HTMLElement","tagName","Camera","Type","__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","UnsupportedBrowserError","_super","browserCompatibility","_this","call","message","data","CustomError","_b","_c","_d","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","pop","__spreadArrays","s","il","arguments","r","k","a","j","jl","CameraAccess","browserHelper_1","camera_1","unsupportedBrowserError_1","getCamerasPromise","backCameraKeywords","cameraObjects","Map","isBackCameraLabel","lowercaseLabel","toLowerCase","some","keyword","getUserMediaVideoParams","resolutionFallbackLevel","isSafariBrowser","width","min","ideal","max","height","enumerateDevices","mediaDevices","MediaStreamTrack","getSources","devices","filter","device","kind","map","deviceId","groupId","toJSON","adjustCamerasFromMainCameraStream","mediaStreamTrack","cameras","mediaTrackSettings","getSettings","activeCamera","find","camera","undefined","activeCameraIsBackFacing","facingMode","activeCameraIsMainBackCamera","forEach","cameraType","BACK","FRONT","mainBackCamera","sort","camera1","camera2","localeCompare","getCameras","accessPermissionPromise","every","getUserMedia","video","audio","stream","error_1","videoDevice","has","backCameraIndex","cameraResolutions","match","parseInt","NaN","cameraResolution","isNaN","lastIndexOf","extractCamerasFromDevices","console","debug","getVideoTracks","track","stop","accessCameraStream","getUserMediaParams","browserName","getBrowser","exact","log","setTimeout","getUserMediaDelayed","ItemTypes","Capture","useRef","downloadAnchor","photo","snap","bboxWrapper0","bboxWrapper1","bboxWrapper2","bboxWrapper3","bboxWrapper4","bboxWrapper5","useState","bboxProperties","setBboxProperties","disp0","disp1","disp2","disp3","disp4","disp5","displayBox","setDisplayBox","x","currentPosition","setCurrentPosition","dragInitPositionDiff","setDragInitPositionDiff","debugData","setDebugData","monitor","useDragDropManager","getMonitor","bboxCount","setBBoxCount","currentBBox","setCurrentBBox","useDrag","type","collect","isDragging","bbox0","isDragging0","bbox1","isDragging1","bbox2","isDragging2","bbox3","isDragging3","bbox4","isDragging4","bbox5","isDragging5","React","useEffect","subscribeToOffsetChange","offset","getClientOffset","initialClientOffset","getInitialClientOffset","initialSourceClientOffset","getInitialSourceClientOffset","useDrop","accept","drop","moveBox","isOver","cbbox","cp","diff","rbox","current","getClientRects","x1","y1","style","left","top","newBboxProperties","id","getVideo","useCallback","res","CamerHelper","mediaStream","srcObject","isSafari","indexOf","reso","newDebugData","JSON","stringify","getCamera","getSupportedConstraints","enumDevices","backDevice","components","key","className","getDebugData","ref","onMouseMove","screenX","screenY","autoPlay","muted","IconButton","color","aria-label","component","variant","onClick","context","innerWidth","innerHeight","drawImage","font","cnt","contentText","strokeText","url","toDataURL","setAttribute","href","download","click","URL","revokeObjectURL","fontSize","newDisplayBox","disabled","src","alt","onTouchStart","onMouseDown","opacity","cursor","display","App","DndProvider","backend","TouchBackend","options","enableMouseEvents","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.e4996509.chunk.js","sourcesContent":["\"use strict\";\r\nexports.__esModule = true;\r\nexports.BrowserCompatibility = void 0;\r\nvar BrowserCompatibility;\r\n(function (BrowserCompatibility) {\r\n    /**\r\n     * Browser feature.\r\n     */\r\n    var Feature;\r\n    (function (Feature) {\r\n        /**\r\n         * [Blob](https://developer.mozilla.org/en-US/docs/Web/API/Blob) -\r\n         * [current support?](https://caniuse.com/#feat=blobbuilder)\r\n         */\r\n        Feature[\"BLOB\"] = \"blob\";\r\n        /**\r\n         * [MediaDevices/getUserMedia](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia) -\r\n         * [current support?](https://caniuse.com/#feat=stream)\r\n         */\r\n        Feature[\"MEDIA_DEVICES\"] = \"mediaDevices\";\r\n        /**\r\n         * [OffscreenCanvas](https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas) -\r\n         * [current support?](https://caniuse.com/#feat=offscreencanvas)\r\n         */\r\n        Feature[\"OFFSCREEN_CANVAS\"] = \"offscreenCanvas\";\r\n        /**\r\n         * [URL/createObjectURL](https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL) -\r\n         * [current support?](https://caniuse.com/#feat=bloburls)\r\n         */\r\n        Feature[\"URL_OBJECT\"] = \"urlObject\";\r\n        /**\r\n         * [Web Workers](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API) -\r\n         * [current support?](https://caniuse.com/#feat=webworkers)\r\n         */\r\n        Feature[\"WEB_WORKERS\"] = \"webWorkers\";\r\n        /**\r\n         * [WebAssembly](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/WebAssembly) -\r\n         * [current support?](https://caniuse.com/#feat=wasm)\r\n         */\r\n        Feature[\"WEB_ASSEMBLY\"] = \"webAssembly\";\r\n        /**\r\n         * WebAssembly without memory corruption (specific iOS version 11.2.2/11.2.5/11.2.6 bug)\r\n         */\r\n        Feature[\"WEB_ASSEMBLY_ERROR_FREE\"] = \"webAssemblyErrorFree\";\r\n        /**\r\n         * [WebGL](https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API) -\r\n         * [current support?](https://caniuse.com/#feat=webgl)\r\n         */\r\n        Feature[\"WEBGL\"] = \"webgl\";\r\n    })(Feature = BrowserCompatibility.Feature || (BrowserCompatibility.Feature = {}));\r\n})(BrowserCompatibility = exports.BrowserCompatibility || (exports.BrowserCompatibility = {}));\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.BrowserHelper = exports.UAParser = void 0;\r\nvar js_cookie_1 = require(\"js-cookie\");\r\nvar ua_parser_js_1 = require(\"ua-parser-js\");\r\nexports.UAParser = ua_parser_js_1.UAParser;\r\nvar browserCompatibility_1 = require(\"./browserCompatibility\");\r\nvar BrowserHelper;\r\n(function (BrowserHelper) {\r\n    /**\r\n     * @hidden\r\n     */\r\n    BrowserHelper.userAgentInfo = new ua_parser_js_1.UAParser(navigator.userAgent);\r\n    /**\r\n     * @hidden\r\n     */\r\n    BrowserHelper.canvas = document.createElement(\"canvas\");\r\n    /**\r\n     * @returns The built [[BrowserCompatibility]] object representing the current OS/Browser's support for features.\r\n     */\r\n    function checkBrowserCompatibility() {\r\n        function objectHasPropertyWithType(object, propertyNames, propertyType) {\r\n            // tslint:disable-next-line:no-any\r\n            var objectProperty = object[propertyNames[0]];\r\n            if (objectProperty == null) {\r\n                return false;\r\n            }\r\n            if (propertyNames.length === 1) {\r\n                return typeof objectProperty === propertyType;\r\n            }\r\n            else {\r\n                return ((typeof objectProperty === \"function\" || typeof objectProperty === \"object\") &&\r\n                    objectHasPropertyWithType(objectProperty, propertyNames.slice(1), propertyType));\r\n            }\r\n        }\r\n        function isBrokenWebAssemblyOS(os) {\r\n            return os.name === \"iOS\" && os.version != null && [\"11.2.2\", \"11.2.5\", \"11.2.6\"].includes(os.version);\r\n        }\r\n        var fullSupport = true;\r\n        var scannerSupport = true;\r\n        var missingFeatures = [];\r\n        if (!objectHasPropertyWithType(navigator, [\"mediaDevices\", \"getUserMedia\"], \"function\") &&\r\n            !objectHasPropertyWithType(navigator, [\"enumerateDevices\"], \"function\") &&\r\n            !objectHasPropertyWithType(window, [\"MediaStreamTrack\", \"getSources\"], \"function\")) {\r\n            missingFeatures.push(browserCompatibility_1.BrowserCompatibility.Feature.MEDIA_DEVICES);\r\n            fullSupport = false;\r\n        }\r\n        if (!objectHasPropertyWithType(window, [\"Worker\"], \"function\")) {\r\n            missingFeatures.push(browserCompatibility_1.BrowserCompatibility.Feature.WEB_WORKERS);\r\n            fullSupport = scannerSupport = false;\r\n        }\r\n        if (!objectHasPropertyWithType(window, [\"WebAssembly\"], \"object\")) {\r\n            missingFeatures.push(browserCompatibility_1.BrowserCompatibility.Feature.WEB_ASSEMBLY);\r\n            fullSupport = scannerSupport = false;\r\n        }\r\n        if (!objectHasPropertyWithType(window, [\"Blob\"], \"function\")) {\r\n            missingFeatures.push(browserCompatibility_1.BrowserCompatibility.Feature.BLOB);\r\n            fullSupport = scannerSupport = false;\r\n        }\r\n        if (!objectHasPropertyWithType(window, [\"URL\", \"createObjectURL\"], \"function\")) {\r\n            missingFeatures.push(browserCompatibility_1.BrowserCompatibility.Feature.URL_OBJECT);\r\n            fullSupport = scannerSupport = false;\r\n        }\r\n        if (!objectHasPropertyWithType(window, [\"OffscreenCanvas\"], \"function\")) {\r\n            missingFeatures.push(browserCompatibility_1.BrowserCompatibility.Feature.OFFSCREEN_CANVAS);\r\n        }\r\n        try {\r\n            if (!objectHasPropertyWithType(window, [\"WebGLRenderingContext\"], \"function\") ||\r\n                (BrowserHelper.canvas.getContext(\"webgl\") == null && BrowserHelper.canvas.getContext(\"experimental-webgl\") == null)) {\r\n                throw new Error();\r\n            }\r\n        }\r\n        catch (_a) {\r\n            missingFeatures.push(browserCompatibility_1.BrowserCompatibility.Feature.WEBGL);\r\n        }\r\n        var userAgentOS = BrowserHelper.userAgentInfo.getOS();\r\n        if (isBrokenWebAssemblyOS(userAgentOS)) {\r\n            missingFeatures.push(browserCompatibility_1.BrowserCompatibility.Feature.WEB_ASSEMBLY_ERROR_FREE);\r\n            fullSupport = scannerSupport = false;\r\n        }\r\n        return {\r\n            fullSupport: fullSupport,\r\n            scannerSupport: scannerSupport,\r\n            missingFeatures: missingFeatures\r\n        };\r\n    }\r\n    BrowserHelper.checkBrowserCompatibility = checkBrowserCompatibility;\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Get a device id for the current browser, when available it's retrieved from a cookie,\r\n     * when not it's randomly generated and stored in a cookie to be retrieved by later calls.\r\n     *\r\n     * @returns The device id for the current browser.\r\n     */\r\n    function getDeviceId() {\r\n        var cookieKey = \"scandit-device-id\";\r\n        var storedDeviceId = js_cookie_1[\"default\"].get(\"scandit-device-id\");\r\n        if (storedDeviceId != null && storedDeviceId !== \"\") {\r\n            return storedDeviceId;\r\n        }\r\n        var hexCharacters = \"0123456789abcdef\";\r\n        var randomDeviceId = \"\";\r\n        for (var i = 0; i < 40; ++i) {\r\n            // tslint:disable-next-line:insecure-random\r\n            randomDeviceId += hexCharacters.charAt(Math.floor(Math.random() * 16));\r\n        }\r\n        js_cookie_1[\"default\"].set(cookieKey, randomDeviceId, { expires: 3650 });\r\n        return randomDeviceId;\r\n    }\r\n    BrowserHelper.getDeviceId = getDeviceId;\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Check if a given object is a valid HTMLElement\r\n     *\r\n     * @param object The object to check.\r\n     * @returns Whether the given object is a valid HTMLElement.\r\n     */\r\n    // tslint:disable-next-line:no-any\r\n    function isValidHTMLElement(object) {\r\n        return (object instanceof HTMLElement ||\r\n            (object != null && typeof object === \"object\" && typeof object.tagName === \"string\"));\r\n    }\r\n    BrowserHelper.isValidHTMLElement = isValidHTMLElement;\r\n})(BrowserHelper = exports.BrowserHelper || (exports.BrowserHelper = {}));\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.Camera = void 0;\r\nvar Camera;\r\n(function (Camera) {\r\n    /**\r\n     * Camera type (not guaranteed to be correct, depending on the device).\r\n     */\r\n    var Type;\r\n    (function (Type) {\r\n        /**\r\n         * Front facing camera.\r\n         */\r\n        Type[\"FRONT\"] = \"front\";\r\n        /**\r\n         * Back facing camera.\r\n         */\r\n        Type[\"BACK\"] = \"back\";\r\n    })(Type = Camera.Type || (Camera.Type = {}));\r\n})(Camera = exports.Camera || (exports.Camera = {}));\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nexports.__esModule = true;\r\nexports.UnsupportedBrowserError = void 0;\r\nvar customError_1 = require(\"./customError\");\r\n/**\r\n * @hidden\r\n */\r\nvar UnsupportedBrowserError = /** @class */ (function (_super) {\r\n    __extends(UnsupportedBrowserError, _super);\r\n    // istanbul ignore next\r\n    function UnsupportedBrowserError(browserCompatibility) {\r\n        var _this = _super.call(this, {\r\n            name: \"UnsupportedBrowserError\",\r\n            message: \"This OS / Browser has one or more missing features preventing it from working correctly\"\r\n        }) || this;\r\n        _this.data = browserCompatibility;\r\n        return _this;\r\n    }\r\n    return UnsupportedBrowserError;\r\n}(customError_1.CustomError));\r\nexports.UnsupportedBrowserError = UnsupportedBrowserError;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nexports.__esModule = true;\r\nexports.CustomError = void 0;\r\nvar CustomError = /** @class */ (function (_super) {\r\n    __extends(CustomError, _super);\r\n    // istanbul ignore next\r\n    function CustomError(_a) {\r\n        var _b = _a === void 0 ? {} : _a, _c = _b.name, name = _c === void 0 ? \"\" : _c, _d = _b.message, message = _d === void 0 ? \"\" : _d;\r\n        var _this = _super.call(this, message) || this;\r\n        Object.setPrototypeOf(_this, CustomError.prototype);\r\n        _this.name = name;\r\n        return _this;\r\n    }\r\n    return CustomError;\r\n}(Error));\r\nexports.CustomError = CustomError;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nexports.__esModule = true;\r\nexports.CameraAccess = void 0;\r\nvar browserCompatibility_1 = require(\"./browserCompatibility\");\r\nvar browserHelper_1 = require(\"./browserHelper\");\r\nvar camera_1 = require(\"./camera\");\r\nvar unsupportedBrowserError_1 = require(\"./unsupportedBrowserError\");\r\n/**\r\n * A helper object to interact with cameras.\r\n */\r\nvar CameraAccess;\r\n(function (CameraAccess) {\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Handle localized camera labels. Supported languages:\r\n     * English, German, French, Spanish (spain), Portuguese (brasil), Portuguese (portugal), Italian,\r\n     * Chinese (simplified), Chinese (traditional), Japanese, Russian, Turkish, Dutch, Arabic, Thai, Swedish,\r\n     * Danish, Vietnamese, Norwegian, Polish, Finnish, Indonesian, Hebrew, Greek, Romanian, Hungarian, Czech,\r\n     * Catalan, Slovak, Ukraininan, Croatian, Malay, Hindi.\r\n     */\r\n    var backCameraKeywords = [\r\n        \"rear\",\r\n        \"back\",\r\n        \"rück\",\r\n        \"arrière\",\r\n        \"trasera\",\r\n        \"trás\",\r\n        \"traseira\",\r\n        \"posteriore\",\r\n        \"后面\",\r\n        \"後面\",\r\n        \"背面\",\r\n        \"后置\",\r\n        \"後置\",\r\n        \"背置\",\r\n        \"задней\",\r\n        \"الخلفية\",\r\n        \"후\",\r\n        \"arka\",\r\n        \"achterzijde\",\r\n        \"หลัง\",\r\n        \"baksidan\",\r\n        \"bagside\",\r\n        \"sau\",\r\n        \"bak\",\r\n        \"tylny\",\r\n        \"takakamera\",\r\n        \"belakang\",\r\n        \"אחורית\",\r\n        \"πίσω\",\r\n        \"spate\",\r\n        \"hátsó\",\r\n        \"zadní\",\r\n        \"darrere\",\r\n        \"zadná\",\r\n        \"задня\",\r\n        \"stražnja\",\r\n        \"belakang\",\r\n        \"बैक\"\r\n    ];\r\n    /**\r\n     * @hidden\r\n     */\r\n    var cameraObjects = new Map();\r\n    /**\r\n     * @hidden\r\n     */\r\n    var getCamerasPromise;\r\n    /**\r\n     * @hidden\r\n     *\r\n     * @param label The camera label.\r\n     * @returns Whether the label mentions the camera being a back-facing one.\r\n     */\r\n    function isBackCameraLabel(label) {\r\n        var lowercaseLabel = label.toLowerCase();\r\n        return backCameraKeywords.some(function (keyword) {\r\n            return lowercaseLabel.includes(keyword);\r\n        });\r\n    }\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Adjusts the cameras' type classification based on the given currently active video stream:\r\n     * If the stream comes from an environment-facing camera, the camera is marked to be a back-facing camera\r\n     * and the other cameras to be of other types accordingly (if they are not correctly set already).\r\n     *\r\n     * The method returns the currently active camera if it's actually the main (back or only) camera in use.\r\n     *\r\n     * @param mediaStreamTrack The currently active `MediaStreamTrack`.\r\n     * @param cameras The array of available [[Camera]] objects.\r\n     * @returns Whether the stream was actually from the main camera.\r\n     */\r\n    function adjustCamerasFromMainCameraStream(mediaStreamTrack, cameras) {\r\n        var mediaTrackSettings;\r\n        if (typeof mediaStreamTrack.getSettings === \"function\") {\r\n            mediaTrackSettings = mediaStreamTrack.getSettings();\r\n        }\r\n        var activeCamera = cameras.find(function (camera) {\r\n            return ((mediaTrackSettings != null && camera.deviceId === mediaTrackSettings.deviceId) ||\r\n                camera.label === mediaStreamTrack.label);\r\n        });\r\n        if (activeCamera !== undefined) {\r\n            var activeCameraIsBackFacing = (mediaTrackSettings != null && mediaTrackSettings.facingMode === \"environment\") ||\r\n                isBackCameraLabel(mediaStreamTrack.label);\r\n            var activeCameraIsMainBackCamera = activeCameraIsBackFacing;\r\n            // TODO: also correct camera types when active camera is not back-facing\r\n            if (activeCameraIsBackFacing && cameras.length > 1) {\r\n                // Correct camera types if needed\r\n                cameras.forEach(function (camera) {\r\n                    if (camera.deviceId === activeCamera.deviceId) {\r\n                        // tslint:disable-next-line:no-any\r\n                        camera.cameraType = camera_1.Camera.Type.BACK;\r\n                    }\r\n                    else if (!isBackCameraLabel(camera.label)) {\r\n                        // tslint:disable-next-line:no-any\r\n                        camera.cameraType = camera_1.Camera.Type.FRONT;\r\n                    }\r\n                });\r\n                var mainBackCamera = cameras\r\n                    .filter(function (camera) {\r\n                    return camera.cameraType === camera_1.Camera.Type.BACK;\r\n                })\r\n                    .sort(function (camera1, camera2) {\r\n                    return camera1.label.localeCompare(camera2.label);\r\n                })[0];\r\n                activeCameraIsMainBackCamera = activeCamera.deviceId === mainBackCamera.deviceId;\r\n            }\r\n            if (cameras.length === 1 || activeCameraIsMainBackCamera) {\r\n                return activeCamera;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    CameraAccess.adjustCamerasFromMainCameraStream = adjustCamerasFromMainCameraStream;\r\n    /**\r\n     * @hidden\r\n     *\r\n     * @param devices The list of available devices.\r\n     * @returns The extracted list of camera objects initialized from the given devices.\r\n     */\r\n    function extractCamerasFromDevices(devices) {\r\n        var cameras = devices\r\n            .filter(function (device) {\r\n            return device.kind === \"videoinput\";\r\n        })\r\n            .map(function (videoDevice) {\r\n            if (cameraObjects.has(videoDevice.deviceId)) {\r\n                return cameraObjects.get(videoDevice.deviceId);\r\n            }\r\n            var label = videoDevice.label != null ? videoDevice.label : \"\";\r\n            var camera = {\r\n                deviceId: videoDevice.deviceId,\r\n                label: label,\r\n                cameraType: isBackCameraLabel(label) ? camera_1.Camera.Type.BACK : camera_1.Camera.Type.FRONT\r\n            };\r\n            if (label !== \"\") {\r\n                cameraObjects.set(videoDevice.deviceId, camera);\r\n            }\r\n            return camera;\r\n        });\r\n        if (cameras.length > 1 &&\r\n            !cameras.some(function (camera) {\r\n                return camera.cameraType === camera_1.Camera.Type.BACK;\r\n            })) {\r\n            // Check if cameras are labeled with resolution information, take the higher-resolution one in that case\r\n            // Otherwise pick the last camera\r\n            var backCameraIndex = cameras.length - 1;\r\n            var cameraResolutions = cameras.map(function (camera) {\r\n                var match = camera.label.match(/\\b([0-9]+)MP?\\b/i);\r\n                if (match != null) {\r\n                    return parseInt(match[1], 10);\r\n                }\r\n                return NaN;\r\n            });\r\n            if (!cameraResolutions.some(function (cameraResolution) {\r\n                return isNaN(cameraResolution);\r\n            })) {\r\n                backCameraIndex = cameraResolutions.lastIndexOf(Math.max.apply(Math, cameraResolutions));\r\n            }\r\n            // tslint:disable-next-line:no-any\r\n            cameras[backCameraIndex].cameraType = camera_1.Camera.Type.BACK;\r\n        }\r\n        return cameras;\r\n    }\r\n    /**\r\n     * Get a list of cameras (if any) available on the device, a camera access permission is requested to the user\r\n     * the first time this method is called if needed.\r\n     *\r\n     * Depending on device features and user permissions for camera access, any of the following errors\r\n     * could be the rejected result of the returned promise:\r\n     * - `UnsupportedBrowserError`\r\n     * - `PermissionDeniedError`\r\n     * - `NotAllowedError`\r\n     * - `NotFoundError`\r\n     * - `AbortError`\r\n     * - `NotReadableError`\r\n     * - `InternalError`\r\n     *\r\n     * @returns A promise resolving to the array of available [[Camera]] objects (could be empty).\r\n     */\r\n    function getCameras() {\r\n        var _this = this;\r\n        if (getCamerasPromise != null) {\r\n            return getCamerasPromise;\r\n        }\r\n        var browserCompatibility = browserHelper_1.BrowserHelper.checkBrowserCompatibility();\r\n        if (!browserCompatibility.fullSupport) {\r\n            return Promise.reject(new unsupportedBrowserError_1.UnsupportedBrowserError(browserCompatibility));\r\n        }\r\n        var accessPermissionPromise = new Promise(function (resolve, reject) {\r\n            return enumerateDevices()\r\n                .then(function (devices) {\r\n                if (devices\r\n                    .filter(function (device) {\r\n                    return device.kind === \"videoinput\";\r\n                })\r\n                    .every(function (device) {\r\n                    return device.label === \"\";\r\n                })) {\r\n                    resolve(navigator.mediaDevices.getUserMedia({\r\n                        video: true,\r\n                        audio: false\r\n                    }));\r\n                }\r\n                else {\r\n                    resolve();\r\n                }\r\n            })[\"catch\"](reject);\r\n        });\r\n        getCamerasPromise = new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\r\n            var stream, devices, cameras, error_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        _a.trys.push([0, 3, 4, 5]);\r\n                        return [4 /*yield*/, accessPermissionPromise];\r\n                    case 1:\r\n                        stream = _a.sent();\r\n                        return [4 /*yield*/, enumerateDevices()];\r\n                    case 2:\r\n                        devices = _a.sent();\r\n                        cameras = extractCamerasFromDevices(devices);\r\n                        console.debug.apply(console, __spreadArrays([\"Camera list: \"], cameras));\r\n                        return [2 /*return*/, resolve(cameras)];\r\n                    case 3:\r\n                        error_1 = _a.sent();\r\n                        // istanbul ignore if\r\n                        if (error_1.name === \"SourceUnavailableError\") {\r\n                            error_1.name = \"NotReadableError\";\r\n                        }\r\n                        return [2 /*return*/, reject(error_1)];\r\n                    case 4:\r\n                        // istanbul ignore else\r\n                        if (stream != null) {\r\n                            stream.getVideoTracks().forEach(function (track) {\r\n                                track.stop();\r\n                            });\r\n                        }\r\n                        getCamerasPromise = undefined;\r\n                        return [7 /*endfinally*/];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); });\r\n        return getCamerasPromise;\r\n    }\r\n    CameraAccess.getCameras = getCameras;\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Call `navigator.mediaDevices.getUserMedia` asynchronously in a `setTimeout` call.\r\n     *\r\n     * @param getUserMediaParams The parameters for the `navigator.mediaDevices.getUserMedia` call.\r\n     * @returns A promise resolving when the camera is accessed.\r\n     */\r\n    function getUserMediaDelayed(getUserMediaParams) {\r\n        console.log(\"Camera access:\", getUserMediaParams.video);\r\n        return new Promise(function (resolve, reject) {\r\n            window.setTimeout(function () {\r\n                navigator.mediaDevices\r\n                    .getUserMedia(getUserMediaParams)\r\n                    .then(resolve)[\"catch\"](reject);\r\n            }, 0);\r\n        });\r\n    }\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Get the *getUserMedia* *video* parameters to be used given a resolution fallback level and the browser used.\r\n     *\r\n     * @param resolutionFallbackLevel The number representing the wanted resolution, from 0 to 6,\r\n     * resulting in higher to lower video resolutions.\r\n     * @param isSafariBrowser Whether the browser is *Safari*.\r\n     * @returns The resulting *getUserMedia* *video* parameters.\r\n     */\r\n    function getUserMediaVideoParams(resolutionFallbackLevel, isSafariBrowser) {\r\n        switch (resolutionFallbackLevel) {\r\n            case 0:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 1920, ideal: 7680, max: 7680 },\r\n                        height: { min: 1440, ideal: 4320, max: 5776 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 1920, ideal: 7680, max: 4096 },\r\n                        height: { min: 1440, ideal: 5776, max: 2180 }\r\n                    };\r\n                }\r\n            case 1:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 3840, ideal: 4096, max: 4096 },\r\n                        height: { min: 2160, ideal: 2160, max: 2160 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 1920, ideal: 4096, max: 4096 },\r\n                        height: { min: 1440, ideal: 2180, max: 2180 }\r\n                    };\r\n                }\r\n            case 2:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 1920, ideal: 3840, max: 4096 },\r\n                        height: { min: 1080, ideal: 2160, max: 2160 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 1920, ideal: 3840, max: 3840 },\r\n                        height: { min: 1440, ideal: 2180, max: 2180 }\r\n                    };\r\n                }\r\n            case 3:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 1400, ideal: 1920, max: 1920 },\r\n                        height: { min: 900, ideal: 1080, max: 1440 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 1400, ideal: 1920, max: 1920 },\r\n                        height: { min: 900, ideal: 1440, max: 1440 }\r\n                    };\r\n                }\r\n            case 4:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 1200, ideal: 1600, max: 1920 },\r\n                        height: { min: 900, ideal: 1080, max: 1200 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 1200, ideal: 1920, max: 1920 },\r\n                        height: { min: 900, ideal: 1200, max: 1200 }\r\n                    };\r\n                }\r\n            case 5:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 1080, ideal: 1600, max: 1920 },\r\n                        height: { min: 900, ideal: 900, max: 1080 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 1080, ideal: 1920, max: 1920 },\r\n                        height: { min: 900, ideal: 1080, max: 1080 }\r\n                    };\r\n                }\r\n            case 6:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 960, ideal: 1280, max: 1440 },\r\n                        height: { min: 480, ideal: 720, max: 960 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 960, ideal: 1280, max: 1440 },\r\n                        height: { min: 480, ideal: 960, max: 960 }\r\n                    };\r\n                }\r\n            case 7:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 720, ideal: 1024, max: 1440 },\r\n                        height: { min: 480, ideal: 768, max: 768 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 720, ideal: 1280, max: 1440 },\r\n                        height: { min: 480, ideal: 720, max: 768 }\r\n                    };\r\n                }\r\n            case 8:\r\n                if (isSafariBrowser) {\r\n                    return {\r\n                        width: { min: 640, ideal: 800, max: 1440 },\r\n                        height: { min: 480, ideal: 600, max: 720 }\r\n                    };\r\n                }\r\n                else {\r\n                    return {\r\n                        width: { min: 640, ideal: 960, max: 1440 },\r\n                        height: { min: 480, ideal: 720, max: 720 }\r\n                    };\r\n                }\r\n            default:\r\n                return {};\r\n        }\r\n    }\r\n    CameraAccess.getUserMediaVideoParams = getUserMediaVideoParams;\r\n\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Try to access a given camera for video input at the given resolution level.\r\n     *\r\n     * @param resolutionFallbackLevel The number representing the wanted resolution, from 0 to 6,\r\n     * resulting in higher to lower video resolutions.\r\n     * @param camera The camera to try to access for video input.\r\n     * @returns A promise resolving to the `MediaStream` object coming from the accessed camera.\r\n     */\r\n    function accessCameraStream(resolutionFallbackLevel, camera) {\r\n        var browserName = browserHelper_1.BrowserHelper.userAgentInfo.getBrowser().name;\r\n        var getUserMediaParams;\r\n        if (resolutionFallbackLevel < 0 ) {\r\n            getUserMediaParams = {\r\n                audio: false,\r\n                video: { facingMode: 'environment' }\r\n              };\r\n        } else {\r\n            getUserMediaParams = {\r\n            audio: false,\r\n            video: getUserMediaVideoParams(resolutionFallbackLevel, browserName != null && browserName.includes(\"Safari\"))}\r\n        };\r\n        if (camera.deviceId === \"\") {\r\n            getUserMediaParams.video.facingMode = {\r\n                ideal: camera.cameraType === camera_1.Camera.Type.BACK ? \"environment\" : \"user\"\r\n            };\r\n        }\r\n        else {\r\n            getUserMediaParams.video.deviceId = {\r\n                exact: camera.deviceId\r\n            };\r\n        }\r\n        console.log(getUserMediaParams);\r\n        return getUserMediaDelayed(getUserMediaParams);\r\n    }\r\n    CameraAccess.accessCameraStream = accessCameraStream;\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Get a list of available devices in a cross-browser compatible way.\r\n     *\r\n     * @returns A promise resolving to the `MediaDeviceInfo` array of all available devices.\r\n     */\r\n    function enumerateDevices() {\r\n        if (typeof navigator.enumerateDevices === \"function\") {\r\n            return navigator.enumerateDevices();\r\n        }\r\n        else if (typeof navigator.mediaDevices === \"object\" &&\r\n            typeof navigator.mediaDevices.enumerateDevices === \"function\") {\r\n            return navigator.mediaDevices.enumerateDevices();\r\n        }\r\n        else {\r\n            return new Promise(function (resolve, reject) {\r\n                try {\r\n                    if (window.MediaStreamTrack == null || window.MediaStreamTrack.getSources == null) {\r\n                        throw new Error();\r\n                    }\r\n                    window.MediaStreamTrack.getSources(function (devices) {\r\n                        resolve(devices\r\n                            .filter(function (device) {\r\n                            return device.kind.toLowerCase() === \"video\" || device.kind.toLowerCase() === \"videoinput\";\r\n                        })\r\n                            .map(function (device) {\r\n                            return {\r\n                                deviceId: device.deviceId != null ? device.deviceId : \"\",\r\n                                groupId: device.groupId,\r\n                                kind: \"videoinput\",\r\n                                label: device.label,\r\n                                toJSON: /* istanbul ignore next */ function () {\r\n                                    return this;\r\n                                }\r\n                            };\r\n                        }));\r\n                    });\r\n                }\r\n                catch (_a) {\r\n                    var browserCompatibility = {\r\n                        fullSupport: false,\r\n                        scannerSupport: true,\r\n                        missingFeatures: [browserCompatibility_1.BrowserCompatibility.Feature.MEDIA_DEVICES]\r\n                    };\r\n                    return reject(new unsupportedBrowserError_1.UnsupportedBrowserError(browserCompatibility));\r\n                }\r\n            });\r\n        }\r\n    }\r\n})(CameraAccess = exports.CameraAccess || (exports.CameraAccess = {}));\r\n","import * as CamerHelper from './cameraAccess';\r\n\r\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport { useDrag, useDragDropManager, useDrop } from 'react-dnd';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport PhotoCamera from '@material-ui/icons/PhotoCamera';\r\nimport SettingsOverscanIcon from '@material-ui/icons/SettingsOverscan';\r\n\r\nconst ItemTypes = {\r\n\tBOUNDARY: 'boundry',\r\n};\r\n\r\nconst Capture = () => {\r\n\tconst debug = true;\r\n\tconst allowedBBoxes = 2;\r\n\tconst video = useRef();\r\n\tconst canvas = useRef();\r\n\tconst downloadAnchor = useRef();\r\n\tconst photo = useRef();\r\n\tconst snap = useRef();\r\n\tconst bboxWrapper0 = useRef();\r\n\tconst bboxWrapper1 = useRef();\r\n\tconst bboxWrapper2 = useRef();\r\n\tconst bboxWrapper3 = useRef();\r\n\tconst bboxWrapper4 = useRef();\r\n\tconst bboxWrapper5 = useRef();\r\n\tconst [bboxProperties, setBboxProperties] = useState();\r\n\tconst [displayBox, setDisplayBox] = useState({\r\n\t\tdisp0: false,\r\n\t\tdisp1: false,\r\n\t\tdisp2: false,\r\n\t\tdisp3: false,\r\n\t\tdisp4: false,\r\n\t\tdisp5: false,\r\n\t});\r\n\tconst [currentPosition, setCurrentPosition] = useState({ x: 0, y: 0 });\r\n\tconst [dragInitPositionDiff, setDragInitPositionDiff] = useState({ x: 0, y: 0 });\r\n\tconst [debugData, setDebugData] = useState([]);\r\n\tconst dragDropManager = useDragDropManager();\r\n\tconst monitor = dragDropManager.getMonitor();\r\n\tconst [bboxCount, setBBoxCount] = useState(0);\r\n\tconst [currentBBox, setCurrentBBox] = useState();\r\n\r\n\tconst [{ isDragging0 }, bbox0] = useDrag(() => ({\r\n\t\ttype: ItemTypes.BOUNDARY,\r\n\t\tcollect: (monitor) => ({\r\n\t\t\tisDragging: !!monitor.isDragging(),\r\n\t\t}),\r\n\t}));\r\n\tconst [{ isDragging1 }, bbox1] = useDrag(() => ({\r\n\t\ttype: ItemTypes.BOUNDARY,\r\n\t\tcollect: (monitor) => ({\r\n\t\t\tisDragging: !!monitor.isDragging(),\r\n\t\t}),\r\n\t}));\r\n\tconst [{ isDragging2 }, bbox2] = useDrag(() => ({\r\n\t\ttype: ItemTypes.BOUNDARY,\r\n\t\tcollect: (monitor) => ({\r\n\t\t\tisDragging: !!monitor.isDragging(),\r\n\t\t}),\r\n\t}));\r\n\tconst [{ isDragging3 }, bbox3] = useDrag(() => ({\r\n\t\ttype: ItemTypes.BOUNDARY,\r\n\t\tcollect: (monitor) => ({\r\n\t\t\tisDragging: !!monitor.isDragging(),\r\n\t\t}),\r\n\t}));\r\n\tconst [{ isDragging4 }, bbox4] = useDrag(() => ({\r\n\t\ttype: ItemTypes.BOUNDARY,\r\n\t\tcollect: (monitor) => ({\r\n\t\t\tisDragging: !!monitor.isDragging(),\r\n\t\t}),\r\n\t}));\r\n\tconst [{ isDragging5 }, bbox5] = useDrag(() => ({\r\n\t\ttype: ItemTypes.BOUNDARY,\r\n\t\tcollect: (monitor) => ({\r\n\t\t\tisDragging: !!monitor.isDragging(),\r\n\t\t}),\r\n\t}));\r\n\r\n\tReact.useEffect(() => {\r\n\t\tmonitor.subscribeToOffsetChange(() => {\r\n\t\t\tconst offset = monitor.getClientOffset();\r\n\t\t\tconst initialClientOffset = monitor.getInitialClientOffset();\r\n\t\t\tconst initialSourceClientOffset = monitor.getInitialSourceClientOffset();\r\n\t\t\tif (initialClientOffset && initialSourceClientOffset) {\r\n\t\t\t\tsetDragInitPositionDiff({\r\n\t\t\t\t\tx: initialClientOffset.x - initialSourceClientOffset.x,\r\n\t\t\t\t\ty: initialClientOffset.y - initialSourceClientOffset.y,\r\n\t\t\t\t});\r\n\t\t\t\tsetCurrentPosition(offset);\r\n\t\t\t}\r\n\r\n\t\t\t// do stuff like setState, though consider directly updating style through refs for performance\r\n\t\t});\r\n\t}, [monitor]);\r\n\r\n\tconst _onMouseMove = (e) => {\r\n\t\tsetCurrentPosition({ x: e.screenX, y: e.screenY });\r\n\t};\r\n\r\n\tconst [{ isOver }, drop] = useDrop(\r\n\t\t() => ({\r\n\t\t\taccept: ItemTypes.BOUNDARY,\r\n\t\t\tdrop: () => moveBox(currentBBox, currentPosition, dragInitPositionDiff),\r\n\t\t\tcollect: (monitor) => ({\r\n\t\t\t\tisOver: !!monitor.isOver(),\r\n\t\t\t}),\r\n\t\t}),\r\n\t\t[currentPosition, dragInitPositionDiff, currentBBox],\r\n\t);\r\n\tconst moveBox = (cbbox, cp, diff) => {\r\n\t\tconst x = cp.x - diff.x;\r\n\t\tconst y = cp.y - diff.y;\r\n\r\n\t\tconst rbox = cbbox.current.getClientRects();\r\n\t\tconst x1 = x + rbox[0].width;\r\n\t\tconst y1 = y + rbox[0].height;\r\n\t\tcbbox.current.style.left = `${x}px`;\r\n\t\tcbbox.current.style.top = `${y}px`;\r\n\t\tconst newBboxProperties = {\r\n\t\t\t...bboxProperties,\r\n\t\t\t[cbbox.current.id]: [\r\n\t\t\t\t{ x, y },\r\n\t\t\t\t{ x: x1, y: y1 },\r\n\t\t\t],\r\n\t\t};\r\n\t\tsetBboxProperties(newBboxProperties);\r\n\t\t// drag.current.left = `${currentPosition.x}px`;\r\n\t\t// drag.current.top = `${currentPosition.y}px`;\r\n\t};\r\n\r\n\tconst getVideo = useCallback(\r\n\t\tasync (device, devices) => {\r\n\t\t\t// console.log(device.getCapabilities())\r\n\t\t\tlet mediaStream;\r\n\t\t\tlet res = 0;\r\n\t\t\ttry {\r\n\t\t\t\tres = -1;\r\n\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(-1, device);\r\n\t\t\t} catch {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tres =0\r\n\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(0, device);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tres = 1;\r\n\t\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(1, device);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tres = 2;\r\n\t\t\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(2, device);\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tres = 3;\r\n\t\t\t\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(3, device);\r\n\t\t\t\t\t\t\t\tvideo.current.srcObject = mediaStream;\r\n\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tres = 4;\r\n\t\t\t\t\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(4, device);\r\n\t\t\t\t\t\t\t\t\tvideo.current.srcObject = mediaStream;\r\n\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\tres = 5;\r\n\t\t\t\t\t\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(5, device);\r\n\t\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\tres = 6;\r\n\t\t\t\t\t\t\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(6, device);\r\n\t\t\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\tres = 7;\r\n\t\t\t\t\t\t\t\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t7,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdevice,\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tres = 8;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmediaStream = await CamerHelper.CameraAccess.accessCameraStream(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t8,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdevice,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t} catch (e) {}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// const newCamera = await CamerHelper.CameraAccess.adjustCamerasFromMainCameraStream(mediaStream, devices)\r\n\t\t\t// console.log(newCamera);\r\n\t\t\tconst isSafari = navigator.userAgent.indexOf('Safari') != -1;\r\n\t\t\tconst reso = CamerHelper.CameraAccess.getUserMediaVideoParams(res, isSafari);\r\n\t\t\tconst newDebugData = { ...debugData };\r\n\t\t\tnewDebugData['resolution'] = res > 0 ? JSON.stringify(reso) : \"generic\";\r\n\t\t\tsetDebugData(newDebugData);\r\n\t\t\tconsole.log(mediaStream);\r\n\t\t\tvideo.current.srcObject = mediaStream;\r\n\t\t},\r\n\t\t[video, canvas, downloadAnchor, photo],\r\n\t);\r\n\r\n\tconst getCamera = useCallback(async () => {\r\n\t\tconst enumDevices = await navigator.mediaDevices.getSupportedConstraints();\r\n\t\t// const videoDevices = enumDevices.filter((device) => (device.kind === 'videoinput'))\r\n\t\tconsole.log(enumDevices);\r\n\t\tconst devices = await CamerHelper.CameraAccess.getCameras();\r\n\t\tconst debugData = {};\r\n\t\tdevices.map((d, i) => (debugData[`Devices Info ${i}`] = JSON.stringify(d)));\r\n\r\n\t\tlet backDevice = devices.filter((device) => device.cameraType === 'back');\r\n\r\n\t\tdebugData['Has Back Camera'] = backDevice.length ? 'true' : 'false';\r\n\t\tdebugData['Back Camera'] = JSON.stringify(backDevice[0]);\r\n\t\tdebugData['Back Camera length'] = JSON.stringify(backDevice.length);\r\n\t\tsetDebugData(debugData);\r\n\t\t// debug.append(div);\r\n\t\tif (backDevice.length) {\r\n\t\t\tgetVideo(backDevice[0], devices);\r\n\t\t} else {\r\n\t\t\tgetVideo(devices[0], devices);\r\n\t\t}\r\n\t}, [getVideo]);\r\n\r\n\tuseEffect(() => {\r\n\t\tgetCamera();\r\n\t\t// console.log(.then(cameras => console.log(cameras)));\r\n\t}, [debug, video, canvas, downloadAnchor, photo, getCamera, getVideo]);\r\n\tconst addBBox = () => {\r\n\t\tconst newDisplayBox = { ...displayBox, [`disp${bboxCount}`]: true };\r\n\t\tconst newCount = bboxCount + 1;\r\n\t\tsetBBoxCount(newCount);\r\n\t\tsetDisplayBox(newDisplayBox);\r\n\t};\r\n\tconst captureImage = () => {\r\n\t\tconst context = canvas.current.getContext('2d');\r\n\t\tcanvas.current.width = window.innerWidth;\r\n\t\tcanvas.current.height = window.innerHeight;\r\n\t\tcontext.drawImage(video.current, 0, 0, window.innerWidth, window.innerHeight);\r\n\t\tcontext.font = '20px Roboto';\r\n\t\tlet cnt = 0;\r\n\t\tfor (let key in bboxProperties) {\r\n\t\t\tconst contentText = `${key} : ${JSON.stringify(bboxProperties[key])}`;\r\n\t\t\tcontext.strokeText(contentText, 10, 20 + 20 * cnt, 1000);\r\n\t\t\tcnt++;\r\n\t\t}\r\n\t\tconst url = canvas.current.toDataURL('image/png');\r\n\t\tphoto.current.setAttribute('src', url);\r\n\t\tdownloadAnchor.current.href = url;\r\n\t\tdownloadAnchor.current.download = 'MyPhoto.png';\r\n\t\tdownloadAnchor.current.click();\r\n\t\t//\r\n\t\twindow.URL.revokeObjectURL(url);\r\n\t};\r\n\r\n\tconst getDebugData = () => {\r\n\t\tconst components = [];\r\n\t\tfor (let key in debugData) {\r\n\t\t\tcomponents.push(\r\n\t\t\t\t<div className='debugRow'>\r\n\t\t\t\t\t<span className='debugLabel'>{key} : </span>\r\n\t\t\t\t\t<span className='debugValue'>{debugData[key]}</span>\r\n\t\t\t\t</div>,\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn components;\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{debug && <div id='debug'>Debug {getDebugData()}</div>}\r\n\t\t\t<div className='container' ref={drop} onMouseMove={_onMouseMove}>\r\n\t\t\t\t<video ref={video} id='video' autoPlay muted></video>\r\n\t\t\t\t<div id='changeVideo'>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tcolor='primary'\r\n\t\t\t\t\t\taria-label='upload picture'\r\n\t\t\t\t\t\tcomponent='span'\r\n\t\t\t\t\t\tvariant='contained'\r\n\t\t\t\t\t\tref={snap}\r\n\t\t\t\t\t\tonClick={captureImage}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<PhotoCamera style={{ fontSize: 100 }} />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div id='additionalButtons'>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tcolor='secondary'\r\n\t\t\t\t\t\taria-label='upload picture'\r\n\t\t\t\t\t\tcomponent='span'\r\n\t\t\t\t\t\tvariant='contained'\r\n\t\t\t\t\t\tref={snap}\r\n\t\t\t\t\t\tonClick={addBBox}\r\n\t\t\t\t\t\tdisabled={bboxCount >= allowedBBoxes}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<SettingsOverscanIcon style={{ fontSize: 100 }} />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div id='handlers'>\r\n\t\t\t\t\t<canvas id='canvas' ref={canvas}>\r\n\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t</canvas>\r\n\t\t\t\t\t<a id='downloadAnchor' href='http://chetandr.github.com' ref={downloadAnchor}>\r\n\t\t\t\t\t\timage\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<img id='photo' ref={photo} src='/logo.svg' alt='Donwload placeholder' />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName='boundingBoxWrapper0'\r\n\t\t\t\t\tid='bbox0'\r\n\t\t\t\t\tref={bboxWrapper0}\r\n\t\t\t\t\tonTouchStart={() => setCurrentBBox(bboxWrapper0)}\r\n\t\t\t\t\tonMouseDown={() => setCurrentBBox(bboxWrapper0)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='boundingBox'\r\n\t\t\t\t\t\tref={bbox0}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\topacity: isDragging0 ? 1 : 1,\r\n\t\t\t\t\t\t\tcursor: 'move',\r\n\t\t\t\t\t\t\tdisplay: displayBox.disp0 ? 'inline-block' : 'none',\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName='boundingBoxWrapper1'\r\n\t\t\t\t\tid='bbox1'\r\n\t\t\t\t\tref={bboxWrapper1}\r\n\t\t\t\t\tonTouchStart={() => setCurrentBBox(bboxWrapper1)}\r\n\t\t\t\t\tonMouseDown={() => setCurrentBBox(bboxWrapper1)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='boundingBox'\r\n\t\t\t\t\t\tref={bbox1}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\topacity: isDragging1 ? 1 : 1,\r\n\t\t\t\t\t\t\tcursor: 'move',\r\n\t\t\t\t\t\t\tdisplay: displayBox.disp1 ? 'inline-block' : 'none',\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName='boundingBoxWrapper2'\r\n\t\t\t\t\tid='bbox2'\r\n\t\t\t\t\tref={bboxWrapper2}\r\n\t\t\t\t\tonTouchStart={() => setCurrentBBox(bboxWrapper2)}\r\n\t\t\t\t\tonMouseDown={() => setCurrentBBox(bboxWrapper2)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='boundingBox'\r\n\t\t\t\t\t\tref={bbox2}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\topacity: isDragging2 ? 1 : 1,\r\n\t\t\t\t\t\t\tcursor: 'move',\r\n\t\t\t\t\t\t\tdisplay: displayBox.disp2 ? 'inline-block' : 'none',\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName='boundingBoxWrapper3'\r\n\t\t\t\t\tid='bbox3'\r\n\t\t\t\t\tref={bboxWrapper3}\r\n\t\t\t\t\tonTouchStart={() => setCurrentBBox(bboxWrapper3)}\r\n\t\t\t\t\tonMouseDown={() => setCurrentBBox(bboxWrapper3)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='boundingBox'\r\n\t\t\t\t\t\tref={bbox3}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\topacity: isDragging3 ? 1 : 1,\r\n\t\t\t\t\t\t\tcursor: 'move',\r\n\t\t\t\t\t\t\tdisplay: displayBox.disp3 ? 'inline-block' : 'none',\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName='boundingBoxWrapper4'\r\n\t\t\t\t\tid='bbox4'\r\n\t\t\t\t\tref={bboxWrapper4}\r\n\t\t\t\t\tonTouchStart={() => setCurrentBBox(bboxWrapper4)}\r\n\t\t\t\t\tonMouseDown={() => setCurrentBBox(bboxWrapper4)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='boundingBox'\r\n\t\t\t\t\t\tref={bbox4}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\topacity: isDragging4 ? 1 : 1,\r\n\t\t\t\t\t\t\tcursor: 'move',\r\n\t\t\t\t\t\t\tdisplay: displayBox.disp4 ? 'inline-block' : 'none',\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName='boundingBoxWrapper5'\r\n\t\t\t\t\tid='bbox5'\r\n\t\t\t\t\tref={bboxWrapper5}\r\n\t\t\t\t\tonTouchStart={() => setCurrentBBox(bboxWrapper5)}\r\n\t\t\t\t\tonMouseDown={() => setCurrentBBox(bboxWrapper5)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='boundingBox'\r\n\t\t\t\t\t\tref={bbox5}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\topacity: isDragging5 ? 1 : 1,\r\n\t\t\t\t\t\t\tcursor: 'move',\r\n\t\t\t\t\t\t\tdisplay: displayBox.disp5 ? 'inline-block' : 'none',\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default Capture;\r\n","import './App.css';\n\nimport { DndProvider, useDrag } from 'react-dnd';\n\nimport Capture from './components/capture';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { TouchBackend } from 'react-dnd-touch-backend';\n\nfunction App() {\n\treturn (\n\t\t<DndProvider backend={TouchBackend} options={{ enableMouseEvents: true }}>\n\t\t\t<div className='App'>\n\t\t\t\t<header className='App-header'>\n\t\t\t\t\t<Capture />\n\t\t\t\t</header>\n\t\t\t</div>\n\t\t</DndProvider>\n\t);\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}